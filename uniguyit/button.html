<htmnl>
<head>
	<meta charset="utf8">
	<style type="text/css">

		.box-area{
			width: 100%;
			margin-top: 12px;
		}

		.main-box{
			padding: 10px;
			color: rgb(31,31,31);
			box-shadow: 0px 0px 6px 1px rgb(204,204,204);
			margin-bottom: 12px;
			cursor: pointer;
			overflow: hidden;
		}

		.main-box:hover{box-shadow: 0px 0px 6px 0px #09C7F7;}

		.main-box input{
			border: none;
			width: 95%;
		}

		.red-circle{
			background: #D56F2B!important;
		}

		.yellow-circle{
			background: #FFFF00!important;
		}

		.green-circle{
			background: #33FF00!important;
		}

		.main-box-del{
			text-decoration: line-through;
			color: rgb(137,137,137);
		}

		.main-box-circle{
			width: 0.7em;
			height: 0.7em;
			border-radius: .35em;
			background: #33FF00;
			margin-right: 20px;
			margin-top: 4px;
		}

		.main-content{
			margin-left: 36px;
			margin-top: -16px;
			word-wrap: break-word; 
			word-break: normal;
		}

		.mb-active{
			box-shadow: 0px 0px 8px 0px #2680D9!important;
		}
	</style>
</head>
<body>
	<div class="box-area">
		<div onclick="changeStatus(this)" class="main-box">
			<div class="main-box-circle"></div>
		 	<div class="main-content">ddssdsddssdsddssdsddssdsddssdsddsssddssdsddssdsddssdsddssdsddssdsddsssddssdsddssdsddssdsddssdsddssdsddsssddssdsddssdsddssdsddssdsddssdsddsssddssdsddssdsddssdsddssdsddssdsddsssddssdsddssdsddssdsddssdsddssdsddsssddssdsddssdsddssdsddssdsddssdsddsssddssdsddss</div>
		</div>
		<div onclick="changeStatus(this)" class="main-box">
			<div class="main-box-circle yellow-circle"></div>
		 	<div class="main-content">dsdfdfd</div>
		</div>
		<div onclick="changeStatus(this)" class="main-box main-box-del">
			<div class="main-box-circle red-circle"></div>
		 	<div class="main-content">这是删除效果,给这个div的父div加main-box-del类</div>
		</div>
		<div onclick="changeStatus(this)" class="main-box">
			<div class="main-box-circle green-circle"></div>
		 	<div class="main-content">elmlkds</div>
		</div>
	</div>
	<div class="btn-group">
		<button onclick="back2Origin()">无</button>
		<button onclick="change2Red()">红</button>
		<button onclick="change2Yellow()">黄</button>
		<button onclick="change2Green()">绿</button>
		<button onclick="addNewBox('新的box')">新建</button>
		<button onclick="selectAllOrNone()">全选/全不选</button>
	</div>
	<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
	<script type="text/javascript">

		var isCtrlKeyPressed=false;

		function changeStatus(obj){
			if(!isCtrlKeyPressed){
				$('.mb-active').toggleClass('mb-active');
			}
			$(obj).addClass('mb-active');
		}

		var isAll=false;
		function selectAllOrNone(){
			if(isAll){
				$('.main-box').addClass('mb-active');
				isAll=false;
			}else{
				$('.main-box').removeClass('mb-active');
				isAll=true;
			}
		}

		function addNewBox(content){
			$('.box-area').append('<div onclick="changeStatus(this)" class="main-box"><div class="main-box-circle"></div><div class="main-content">'+content+'</div></div>');
		}

		function selectAll(){
			$('.main-box').toggleClass('mb-active');
		}

		function toColor(colorName,isRed){
			isRed=isRed==null?false:true;
			colorName=colorName==null?'':colorName;
			if(colorName!=''){
				if($('.mb-active').length==0){
					alert('没有选中的项目');
				}else{
					$('.mb-active .main-box-circle').attr('class','main-box-circle '+colorName+'-circle');
					if(isRed){
						$('.mb-active').attr('class','main-box mb-active main-box-del');
					}else{
						$('.mb-active').removeClass('main-box-del');
					}
				}	
			}else{
				if($('.mb-active').length==0){
					alert('没有选中的项目');
				}else{
					$('.mb-active').removeClass('main-box-del');
					var colorList=['red','yellow','green'];
					for (var i = 0; i < colorList.length; i++) {
						$('.mb-active .main-box-circle').removeClass(colorList[i]+'-circle');
					}
					$('.mb-active').removeClass('.mb-active');
				}
			}
		}

		function back2Origin(){
			toColor();
		}

		function displayGreenBox(content){
			$('.box-area').append('<div ondblclick="edit(this)" class="main-box edit-box"><div class="main-box-circle"></div><div class="main-content">'+content+'</div></div>');
		}

		function edit(obj){
			if($(obj).find('.main-content').find('input').length==0){
				var value=$(obj).find('.main-content').html();
				$(obj).find('.main-content').html('');
				$(obj).find('.main-content').append('<input value='+value+' type="text"><button onclick="submitGreenBox(this)">submit</button>');
			}
		}

		function submitGreenBox(obj){
			$(obj).parent().html($(obj).prev().val());
		}

		function change2Red(){
			toColor('red',true);
			displayGreenBox('绿色可编辑格子');
		}

		function change2Yellow(){
			toColor('yellow');
		}

		function change2Green(){
			toColor('green');
		}

		$(document).bind("click",function(e){
			var target=$(e.target);
			if(target.closest(".main-box,.btn-group").length==0){
				$('.mb-active').removeClass('mb-active');
			};
			e.stopPropagation();
		});

		$(document).keydown(function(e){
			if(e.ctrlKey==1){
				isCtrlKeyPressed=true;
			}
		});

		$(document).keyup(function(e){
			if(e.ctrlKey==1){
				isCtrlKeyPressed=false;
			}
		});
	</script>
</body>
</htmnl>